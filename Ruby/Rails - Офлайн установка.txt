1. Загрузить Ruby (http://rubyinstaller.org/downloads), распаковать в d:\programs\ruby\. Добавить в PATH d:\programs\ruby\bin;

2. Загрузить RubyGems (http://rubygems.org/pages/download), распаковать в d:\programs\ruby\rubygems\;

3. Загрузить DevKit (http://rubyinstaller.org/downloads), распаковать в d:\programs\ruby\devkit\. Зайти туда, там выполнить:
> ruby dk.rb init
В конфиге config.yml вписать путь до установленного Ruby, если само не нашло:
- d:/programs/ruby

Пример файла:

# This configuration file contains the absolute path locations of all
# installed Rubies to be enhanced to work with the DevKit. This config
# file is generated by the 'ruby dk.rb init' step and may be modified
# before running the 'ruby dk.rb install' step. To include any installed
# Rubies that were not automagically discovered, simply add a line below
# the triple hyphens with the absolute path to the Ruby root directory.
#
# Example:
#
# ---
# - C:/ruby19trunk
# - C:/ruby192dev
#
---
- c:/programs/ruby

Запустить установку:
> ruby dk.rb install

4. Загрузить список gem'ов (https://rubygems.org/), поместить их в d:\programs\ruby\:

actionmailer-4.2.2.gem
actionpack-4.2.2.gem
actionview-4.2.2.gem
activejob-4.2.2.gem
activemodel-4.2.2.gem
activerecord-4.2.2.gem
activesupport-4.2.2.gem
arel-6.0.0.gem
builder-3.2.2.gem
bundler-1.10.4.gem
erubis-2.7.0.gem
globalid-0.3.5.gem
i18n-0.7.0.gem
loofah-2.0.2.gem
mail-2.6.3.gem
mime-types-2.6.1.gem
mini_portile-0.6.2.gem
nokogiri-1.6.5-x64-mingw32.gem (http://www.nokogiri.org/tutorials/installing_nokogiri.html#windows)
rack-1.6.4.gem
rack-test-0.6.3.gem
rails-4.2.2.gem
rails-deprecated_sanitizer-1.0.3.gem
rails-dom-testing-1.0.6.gem
rails-html-sanitizer-1.0.2.gem
railties-4.2.2.gem
sprockets-3.2.0.gem
sprockets-rails-2.3.2.gem
thor-0.19.1.gem
thread_safe-0.3.5.gem
tzinfo-1.2.2.gem

5. Перейти в каталог d:\programs\ruby\ и выполнить команду:
> gem install rails-4.2.2.gem

Успешность установки можно проверить командой:
> rails -v

6. Установка sqlite

Загрузить sqlite (https://www.sqlite.org/download.html), как dll, так и Source Code с autoconf. Положить в d:\programs\sqlite\. Выполнить http://stackoverflow.com/a/16023062.

Загрузить sqlite3-1.3.10.gem.

Выполнить команду:

> gem install sqlite3-1.3.10.gem --local --platform=ruby -- '--with-sqlite3-dir="c:/programs/sqlite" --with-sqlite3-lib="c:/programs/sqlite/.libs" --with-sqlite3-include="c:/programs/sqlite"'

Установка завершена, далее по манулу: http://guides.rubyonrails.org/getting_started.html#creating-the-blog-application создаём где-то каталог для проектов, например D:\code\ruby\, заходим в него и выполняем команду:

> rails new someapp

Он создаём нужные папки, запускает bundle install и... отваливается с ошибкой о недостаче того или иного gem'а.

ПИКЧА С ОПРОКИДЫВАНИЕМ СТОЛА

Я всё понял, офлайн установка Ruby on Rails под Windows - плохая идея.